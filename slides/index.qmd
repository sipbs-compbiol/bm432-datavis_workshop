---
title: "BM432 Data Visualisation Workshop"
author: 
  - name: "Morgan Feeney"
    affiliation: "University of Strathclyde"
  - name: "Leighton Pritchard"
    affiliation: "University of Strathclyde"
date: "2024-10-22"
format: 
  revealjs:
    slide-number: true
    controls: true
    preview-links: auto    
    footer: "BM432 Data Visualisation Workshop"
    logo: images/science_logo_400x400.jpg
    theme: [default, ./includes/custom.scss]
    width: 1280
    height: 720
    self-contained: true
---

```{r setup, include=FALSE}
# Package imports
library(dplyr)
library(ggplot2)
library(ggthemes)
library(googlesheets4)
library(htmltools)
library(knitr)
library(stringr)
library(tidyr)
library(tm)
library(wordcloud)
library(wordcloud2)

# Authenticate with Google Forms
gs4_deauth()

# Grab data and clean it
# dfm = read_sheet("https://docs.google.com/spreadsheets/d/1Qs3Hdeycu9Q8KBqpQ6qlv6NaUW62Al_PPWF96x1lACI/edit?resourcekey=&gid=1498908795#gid=1498908795")
dfm <- read_sheet("https://docs.google.com/spreadsheets/d/1e4i7g-zfEiDmMFZMXMzm4gqddGc7HVBFEDfGeLTeFnM/edit?resourcekey=&gid=12171434#gid=12171434")
# 2025-26 Google Form location
# https://docs.google.com/forms/d/e/1FAIpQLSf2HbFQUkw2Ookp65Q_aLnsEGh3wRS0ZOta6Q7f2s-EFs4V6A/viewform?usp=header
# 2025-26 Google Form response spreadsheet
# https://docs.google.com/spreadsheets/d/1e4i7g-zfEiDmMFZMXMzm4gqddGc7HVBFEDfGeLTeFnM/edit?resourcekey=&gid=12171434#gid=12171434
colnames(dfm) = c("timestamp",
                  "grade_fig1", "explain_fig1", "improvements_fig1", "questions_fig1",
                  "grade_fig2", "explain_fig2", "improvements_fig2", "questions_fig2",
                  "grade_fig3", "explain_fig3", "improvements_fig3", "questions_fig3",
                  "grade_fig4", "explain_fig4", "improvements_fig4", "questions_fig4",
                  "other_comments")

# Ignore responses prior to a given date
dfm = dfm %>% filter(timestamp > "2025-10-10")
```

# 1. Introduction

## Learning Objectives

- You should be able to critically analyse how data is visualised 
- You should be able to judge a figure's clarity and potential for misunderstanding
- You should be able to identify potential sources of bias resulting from the visualisation
- You should understand how to create effective figures for your own work

# 2. Bad and Good Data Visualisations

# 3. Critique of Published Scientific Figures

## Example 1 

:::: {.columns}

::: {.column width="40%"}
Small molecules identified in previous HTS increase GCase activity. 
:::

::: {.column width="60%"}
<center>
<img src="images/figure1-0.png" />
</center>
:::

::::

## Your Critical Analysis of Example 1

[Leighton to add fancy Google form code here]

## Critique 1.1

:::: {.columns}

::: {.column width="40%"}

::: { .callout-warning title="Issue" }
Dynamite plot: the lower extent of these error bars is not visible.
:::

::: { .callout-tip title="Solution" }
Use boxplots or 1D scatterplots
:::

:::

::: {.column width="60%"}
![](images/figure1-1.png)
:::

::::

## Critique 1.2

:::: {.columns}

::: {.column width="40%"}

::: { .callout-warning title="Issue" }
Incomplete presentation of statistical comparisons, e.g is there a difference between A16 and A18 in (B)?
:::

::: { .callout-tip title="Solution" }
Present a table of statistical differences instead, or alongside the figure.
:::

:::

::: {.column width="60%"}
![](images/figure1-2.png)
:::

::::

## Critique 1.3

:::: {.columns}

::: {.column width="40%"}

::: { .callout-warning title="Issue" }
Distance between bars makes comparison awkward.
:::

::: { .callout-tip title="Solution" }
Place things to be compared by the reader next to each other where possible, to facilitate visual comparison.
:::

:::

::: {.column width="60%"}
![](images/figure1-3.png)
:::

::::

## Critique 1.4

:::: {.columns}

::: {.column width="40%"}

::: { .callout-warning title="Issue" }
The scale on the micrographs (especially in panel C) is too small to read easily.
:::

::: { .callout-tip title="Solution" }
Increase the size of the scale relative to the figure so it can be read.
:::

:::

::: {.column width="60%"}
![](images/figure1-4.png)
:::

::::

## Critique 1.5

:::: {.columns}

::: {.column width="40%"}

::: { .callout-warning title="Issue" }
A visual control (bright-field image) is absent.
:::

::: { .callout-tip title="Solution" }
In addition to showing DAPI and immunofluorescence images of the cells, include a bright-field micrograph of the cells (no fluorescence). 
:::

:::

::: {.column width="60%"}
![](images/figure1-5.png)
:::

::::

## Critique 1.6

:::: {.columns}

::: {.column width="40%"}

::: { .callout-warning title="Issue" }
The colour scheme is misleading because saturation represents different data across figure panels (compare 1 $\mu$M A18 in B vs 5 $\mu$M in D, and 1 $\mu$M A18 in E). 
:::

::: { .callout-tip title="Solution" }
Be consistent with the visual messaging of colour (hue, saturation, and luminance). 
:::

:::

::: {.column width="60%"}
![](images/figure1-6.png)
:::

::::

## Critique 1.7

:::: {.columns}

::: {.column width="40%"}

::: { .callout-warning title="Issue" }
Too many comparisons in B clutter the figure and compress the space available for showing data. 
:::

::: { .callout-tip title="Solution" }
Present a table of statistical differences instead, or alongside the figure, to reduce clutter.
:::

:::

::: {.column width="60%"}
![](images/figure1-7.png)
:::

::::

## Critique 1.8

:::: {.columns}

::: {.column width="40%"}

::: { .callout-warning title="Issue" }
$y$-axis scales vary between panels, so quantitative comparison between panels is difficult.
:::

::: { .callout-tip title="Solution" }
Use the same $y$-axis scale in all panels to facilitate direct comparison.
:::

:::

::: {.column width="60%"}
![](images/figure1-8.png)
:::

::::

## Our Critical Analysis

[I think it would be a nice way to wrap each figure up if we also gave each figure a mark? Or, we could put in a Slido poll here to ask them to revise their mark?]

## Example 2 

:::: {.columns}

::: {.column width="40%"}
Endometriosis-associated macrophages exhibit significant transcriptomic heterogeneity.  
:::

::: {.column width="60%"}
<center>
<img src="images/figure2-0.png" />
</center>
:::

::::

## Your Critical Analysis of Example 2

[Leighton to add fancy Google form code here]

## Critique 2.1

:::: {.columns}

::: {.column width="40%"}
UMAP plots (B, E) are highly manipulable and clustering/placement does not necessarily reflect objective measures.
:::

::: {.column width="60%"}
<center>
<img src="images/figure2-1.png" />
</center>
:::

::::

## Critique 2.2

:::: {.columns}

::: {.column width="40%"}
Unpleasant colour choices in (C); there is room for aesthetic improvement
:::

::: {.column width="60%"}
<center>
<img src="images/figure2-2.png" />
</center>
:::

::::

## Critique 2.3

:::: {.columns}

::: {.column width="40%"}
The proportion plot in (C) does not give information on absolute number, only proportion; a proportional areas plot spanning all clusters would more honestly represent the data
:::

::: {.column width="60%"}
<center>
<img src="images/figure2-3.png" />
</center>
:::

::::

## Critique 2.4

:::: {.columns}

::: {.column width="40%"}
Heatmap text is too small to read comfortably; is there too much data here?
:::

::: {.column width="60%"}
<center>
<img src="images/figure2-4.png" />
</center>
:::

::::

## Critique 2.5

:::: {.columns}

::: {.column width="40%"}
Heatmap is missing a scale (is purple high and yellow low, or vice versa?)
:::

::: {.column width="60%"}
<center>
<img src="images/figure2-5.png" />
</center>
:::

::::

## Critique 2.6

:::: {.columns}

::: {.column width="40%"}
The flow diagram (A) could make better use of arrows to illustrate order of steps 
:::

::: {.column width="60%"}
<center>
<img src="images/figure2-6.png" />
</center>
:::

::::

## Critique 2.7

:::: {.columns}

::: {.column width="40%"}
Text overall is too small, and hard to read comfortably 
:::

::: {.column width="60%"}
<center>
<img src="images/figure2-7.png" />
</center>
:::

::::

## Critique 2.8

:::: {.columns}

::: {.column width="40%"}
Whitespace usage could be improved, and the overall flow of the figure - in particular, cramming (C) under the inset from (B) makes the figure feel very crowded

:::

::: {.column width="60%"}
<center>
<img src="images/figure2-8.png" />
</center>
:::

::::

## Critique 2.9

:::: {.columns}

::: {.column width="40%"}
Consider what is needed to convey the figure's intended message: if it's just that these macrophages exhibit transcriptional heterogeneity, then D is probably sufficient for that purpose; if it is some other message, then revise for clarity. 

:::

::: {.column width="60%"}
<center>
<img src="images/figure2-9.png" />
</center>
:::

::::

## Example 3 

:::: {.columns}

::: {.column width="40%"}
A *C. difficile* mutant lacking all three YkuD-type Ldts (Δ*ldt1-3*) exhibits wild-type growth, morphology, and 3-3 cross-linking.  
:::

::: {.column width="60%"}
<center>
<img src="images/figure3-0.png" />
</center>
:::

::::

## Your Critical Analysis of Example 3

[Leighton to add fancy Google form code here]

## Critique 3.1

:::: {.columns}

::: {.column width="40%"}
The lower extent of error bars is not visible in (D) or (E). These are "dynamite plots," which should be avoided
:::

::: {.column width="60%"}
<center>
<img src="images/figure3-1.png" />
</center>
:::

::::

## Critique 3.2

:::: {.columns}

::: {.column width="40%"}
Bar charts should be avoided in general; a 1D scatterplot of each dataset in (D) and (E) would be clearer
:::

::: {.column width="60%"}
<center>
<img src="images/figure3-2.png" />
</center>
:::

::::

## Critique 3.3

:::: {.columns}

::: {.column width="40%"}
Failure to complement the triple mutant strain - missing data??? This is a control I would expect to see for these experiments.
:::

::: {.column width="60%"}
<center>
<img src="images/figure3-3.png" />
</center>
:::

::::

## Critique 3.4

:::: {.columns}

::: {.column width="40%"}
Labels should not be placed where they obscure part of an image.
:::

::: {.column width="60%"}
<center>
<img src="images/figure3-4.png" />
</center>
:::

::::

## Critique 3.5

:::: {.columns}

::: {.column width="40%"}
Fluorescence wavelength not specified 
:::

::: {.column width="60%"}
<center>
<img src="images/figure3-5.png" />
</center>
:::

::::

## Critique 3.6

:::: {.columns}

::: {.column width="40%"}
Colour scheme in (A), and between B and D/E, is inconsistent - more rational, and helpful, colour choices could be made here.
:::

::: {.column width="60%"}
<center>
<img src="images/figure3-6.png" />
</center>
:::

::::

## Critique 3.7

:::: {.columns}

::: {.column width="40%"}
Axis label in (B) could be improved - OD<sub>600</sub> is not very informative.

:::

::: {.column width="60%"}
<center>
<img src="images/figure3-7.png" />
</center>
:::

::::

## Critique 3.8

:::: {.columns}

::: {.column width="40%"}
Figure legend for (A) could be more succinct/some of this info should be in the paper text instead. Overall a figure legend should provide enough detail for the figure to stand alone, but should not describe results/significance.

:::

::: {.column width="60%"}
<center>
<img src="images/figure3-0.png" />
</center>
:::

::::

## Example 4 

:::: {.columns}

::: {.column width="40%"}
Functional characterization and overall structure of Rv1217c–1218c.  
:::

::: {.column width="60%"}
<center>
<img src="images/figure4-0.png" />
</center>
:::

::::

## Your Critical Analysis of Example 4

[Leighton to add fancy Google form code here]

## Critique 4.1

:::: {.columns}

::: {.column width="40%"}
The rifampicin structure is purely decorative and could be removed - avoid needless distractions in figures.
:::

::: {.column width="60%"}
<center>
<img src="images/figure4-1.png" />
</center>
:::

::::

## Critique 4.2

:::: {.columns}

::: {.column width="40%"}
The lower extent of error bars is not visible in (B). This is a "dynamite plot," which should be avoided
:::

::: {.column width="60%"}
<center>
<img src="images/figure4-2.png" />
</center>
:::

::::

## Critique 4.3

:::: {.columns}

::: {.column width="40%"}
Bar charts should be avoided in general; a 1D scatterplot of each dataset in (B) would be clearer. 
:::

::: {.column width="60%"}
<center>
<img src="images/figure4-3.png" />
</center>
:::

::::

## Critique 4.4

:::: {.columns}

::: {.column width="40%"}
Colour scheme in (B) doesn't seem purposeful and doesn't add anything to the figure 
:::

::: {.column width="60%"}
<center>
<img src="images/figure4-4.png" />
</center>
:::

::::

## Critique 4.5

:::: {.columns}

::: {.column width="40%"}
The implied membrane in (C) and (D) could be stated as such in the figure.
:::

::: {.column width="60%"}
<center>
<img src="images/figure4-5.png" />
</center>
:::

::::

## Critique 4.6

:::: {.columns}

::: {.column width="40%"}
By convention in microbiology, we would assume that the periplasm/extracellular space is "up" and the cytoplasm is "down" in (C) and (D) - but this should really be labelled to avoid any potential confusion.
:::

::: {.column width="60%"}
<center>
<img src="images/figure4-6.png" />
</center>
:::

::::

## Critique 4.7

:::: {.columns}

::: {.column width="40%"}
Colours in (A) difficult to distinguish, especially with the red boxes which seem to skew blue closer to purple - this could be presented more clearly.
:::

::: {.column width="60%"}
<center>
<img src="images/figure4-7.png" />
</center>
:::

::::

## Critique 4.8

:::: {.columns}

::: {.column width="40%"}
Showing two cut-out bands is not an appropriate way to show Western blot data - show the whole blot
:::

::: {.column width="60%"}
<center>
<img src="images/figure4-8.png" />
</center>
:::

::::

## Critique 4.9

:::: {.columns}

::: {.column width="40%"}
Text in (D) is too small to read easily
:::

::: {.column width="60%"}
<center>
<img src="images/figure4-9.png" />
</center>
:::

::::

# 4. Summing Up

## General Comments

- Data presentation choices
- Colour choices
- Larger figures/graphs, more space between figures/graphs
- Too much data per figure 
  - Split into multiple figures 
  - Remove unnecessary data (how do we define this?)
- “The data is presented in a manner that would likely be inaccessible for people without prior experience. A move toward a more palatable/digestible format will facilitate better science communication in the future.”

## Further Reading

- Introduction to Data Visualisation
  - [https://sipbs-compbiol.github.io/bm432-datavis_workshop](https://sipbs-compbiol.github.io/bm432-datavis_workshop)
  
- Additional information:
  - ["Fundamentals of Data Visualisation" _by Claus O. Wilke_](https://clauswilke.com/dataviz/)
  - ["Data Visualisation: A Practical Introduction" _by Kieran Healy_](https://socviz.co/index.html#preface)
  - ["Points of View: graphic design for data visualisation"](https://communities.springernature.com/posts/data-visualization-a-view-of-every-points-of-view-column)
