---
title: "Better Tools Than Bar Charts"
description: |
 Improved visualisations for when you might otherwise reach for bar charts
number-sections: true
about:
  template: marquee
  links:
    - icon: twitter
      text: Twitter
      href: https://twitter.com/scompbiol
    - icon: github
      text: Github
      href: https://github.com/sipbs-compbiol
    - icon: envelope
      text: Email
      href: mailto:leighton.pritchard@strath.ac.uk
html:
  anchor-sections: true
execute:
  warning: false
embed-resources: false
---

```{r setup, include=FALSE}
library("DT")
library("datasets")
library("dplyr")
library("readr")
library("stringr")
library("tidyr")
library("kableExtra")

# BG color for plots - should match .figure and .caption classes in rmd_style.css
figbg = "whitesmoke"

# Cohort dataset
data = anscombe %>% pivot_longer(
    everything(),
    cols_vary = "slowest",
    names_to = c(".value", "set"),
    names_pattern = "(.)(.)"
  ) %>% rename(all_of(c(cohort="set", dosage="x", effect="y")))
```

::: { .callout-case-study }
Over the course of a small study, you attempted to evaluate the effect of a drug on four different matched `cohort`s of 11 individuals, specifying `dosage` per individual and measuring the drug `effect`.

The interactive examples below ask you to visualise alternative representations of this data.
:::

::: { .callout-note }
In this dataset, `cohort` is a categorical variable, but `dosage` and `effect` are continuous variables.
:::

::: { .callout-data collapse="true" title="Click to view the complete dataset as a table"}
```{r datatable, echo=FALSE}
datatable(data)
```
:::

## Visualising numerical datasets

::: { .callout-challenge }
In the interactive examples below, you can select alternative visualisations of the case study dataset, and decide for yourself which presents the most appropriate story about the data.
:::

::: { .panel-tabset }

## Bar chart

::: {layout-ncol=2}
![Dosage for each cohort (bar chart)](assets/images/bar_dosage.png){#fig-bar-dose}

![Effect for each cohort (bar chart)](assets/images/bar_effect.png){#fig-bar-effect}
:::

## Bar + Errors

::: {layout-ncol=2}
![Dosage for each cohort (bar chart with error bars representing standard deviation)](assets/images/bar_errors_dosage.png){#fig-bar-data-dose}

![Effect for each cohort (bar chart with error bars representing standard deviation)](assets/images/bar_errors_effect.png){#fig-bar-data-effect}
:::

## 1D Scatter

::: {layout-ncol=2}
![Dosage for each cohort (1D scatterplot)](assets/images/1d_scatter_dosage.png){#fig-1d-dose}

![Effect (1D scatterplot)](assets/images/1d_scatter_effect.png){#fig-1d-effect}
:::

## Boxplot

::: {layout-ncol=2}
![Dosage for each cohort (boxplot)](assets/images/box_dosage.png){#fig-box-dose}

![Effect for each cohort (boxplot)](assets/images/box_effect.png){#fig-box-effect}
:::

## Violin

::: {layout-ncol=2}
![Dosage for each cohort (violin plot)](assets/images/violin_dosage.png){#fig-violin-dose}

![Effect for each cohort (violin plot)](assets/images/violin_effect.png){#fig-violin-effect}
:::

## Bar + Data

::: {layout-ncol=2}
![Dosage for each cohort (bar chart, standard deviation error bars, overlaid 1D scatterplot)](assets/images/bar_data_dosage.png){#fig-bar-data-dose}

![Effect for each cohort (bar chart, standard deviation error bars, overlaid 1D scatterplot)](assets/images/bar_data_effect.png){#fig-bar-data-effect}
:::

## Box + Data

::: {layout-ncol=2}
![Dosage for each cohort (box plot, overlaid 1D scatterplot)](assets/images/box_data_dosage.png){#fig-box-data-dose}

![Effect for each cohort (box plot, overlaid 1D scatterplot)](assets/images/box_data_effect.png){#fig-box-data-effect}
:::

## Violin + Data

::: {layout-ncol=2}
![Dosage for each cohort (violin plot, overlaid 1D scatterplot)](assets/images/violin_data_dosage.png){#fig-violin-data-dose}

![Effect for each cohort (violin plot, overlaid 1D scatterplot)](assets/images/violin_data_effect.png){#fig-violin-data-effect}
:::

:::

::: { .callout-questions }
1. Did any of the visualisations give a good summary account of the data, and why did you think so?
2. Did any of the visualisations give a poor summary account of the data, and why did you think so?
3. If someone presented a bar chart as a summary of measurements in a dataset, would you think that was a reliable visual representation?
4. What kinds of problems in these datasets were disguised by each visualisation approach?
:::

::: { .callout-hints collapse="true" }
1. Does the visualisation describe the data, or only a summary of the data?
2. Does the visualisation let you easily tell the difference between two datasets with similar summaries, but different data?
3. Does the visualisation introduce elements that imply the presence of data which is not in the dataset?
:::

## Visualising correlations

::: { .callout-data }
In the interactive window below, you can select alternative visualisations of the case study dataset, and decide for yourself which presents the most appropriate story about the data.
:::

::: { .panel-tabset }

## Regression

![Linear regression of effect against dosage, for each cohort.](assets/images/regression.png){#fig-regression}

## Ribbon

![Regression plot of effect against dosage, for each cohort, with ribbon indicating 95% confidence interval for the fitted line.](assets/images/regression_ribbon.png){#fig-regression-ribbon}

## Scatterplot

![Scatterplot of effect against dosage for each cohort.](assets/images/scatterplot.png){#fig-scatterplot}

## Regression/Scatter

![Regression plot of effect against dosage for each cohort, with overlaid scatterplot.](assets/images/regression_scatter.png){#fig-regression-scatter}

## Regression/Ribbon/Scatter

![Regression plot of effect against dosage for each cohort, with 95% confidence interval ribbon and scatterplot](assets/images/regression_ribbon_scatter.png){#fig-regression-scatter-ribbon}

:::

::: { .callout-questions }
1. Do the parameters or correlation coefficients of the fitted linear regressions differ by cohort?
2. Do the linear regressions give a good account of the relationship between dosage and effect, in each case?
3. Does the plotted uncertainty in the linear regression capture the variation between the real data, and linear regression?
4. Are there any signs of systematic problems in the data?
5. What kind of visualisation is most helpful to understand these datasets?
:::

::: { .callout-hints collapse="true" }
1. Does the regression fully describe the data, or is it only a summary of the data?
2. Does the uncertainty in the regression adequately describe the variation of the data with respect to the fitted line?
3. Which visualisations best allow you to see differences between the datasets?
:::